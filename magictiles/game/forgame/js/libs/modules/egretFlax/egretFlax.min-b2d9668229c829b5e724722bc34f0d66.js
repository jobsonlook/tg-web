var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Anchor=function(){function t(t){this.x=0,this.y=0,this.zIndex=0,this.rotation=0,this.scaleX=1,this.scaleY=1,t=t.split(","),this.x=parseFloat(t[0]),this.y=parseFloat(t[1]),t.length>2&&(this.zIndex=parseInt(t[2])),t.length>3&&(this.rotation=parseFloat(t[3])),t.length>4&&(this.scaleX=parseFloat(t[4])),t.length>5&&(this.scaleY=parseFloat(t[5]))}return t}(),XSprite=function(t){function e(e,i){var n=t.call(this)||this;if(n.frameNames=null,n._autoPlayChildren=!1,n._frameDatas=null,n._theRect=null,n.namedChildren=null,n.__instanceId=null,n.onAnimationOver=null,n.onSequenceOver=null,n.onFrameChanged=null,n.onFrameLabel=null,n.autoDestroyWhenOver=!1,n.autoStopWhenOver=!1,n.autoHideWhenOver=!1,n.autoRecycle=!1,n.currentFrame=0,n.currentAnim=null,n.totalFrames=0,n.frameInterval=0,n.ignoreBodyRotation=!1,n.define=null,n.assetsFile=null,n.assetID=null,n.__pool__id__=null,n.clsName="XSprite",n.playing=!1,n._prevFrame=-1,n._labelFrames=null,n._labelSounds=null,n._loopStart=0,n._loopEnd=0,n._isLanguageElement=!1,n.__isFlaxSprite=!0,n.__isInputMask=!1,n._fps=24,n._colliders=null,n._mainCollider=null,n._definedMainCollider=!1,n._anchorBindings=null,n._inited=!1,n._mouseEnabled=!0,n._baseAssetID=null,n._subAnims=null,n._animSequence=null,n._loopSequence=!1,n._sequenceIndex=0,n._fpsForAnims=null,n.__isMovieClip=!1,n._frameSounds=null,n._destroyed=!1,n.__isButton=!1,n._animTime=0,n._animReversed=!1,!e||!i)throw"Please set assetsFile and assetID to me!";return n.bitmap=new egret.Bitmap,n.addChild(n.bitmap),n.touchChildren=!1,n.touchEnabled=!0,n.setSource(e,i),n.setPixelHitTest(!0),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n._onRomoveFromStage,n),n}return __extends(e,t),e.prototype._onRomoveFromStage=function(){this.stop(),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this._onRomoveFromStage,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},e.prototype.setPixelHitTest=function(t){this.bitmap.pixelHitTest=t},e.prototype.removeAllDefineChildren=function(){},e.prototype.setSource=function(t,e){if(this.removeAllDefineChildren(),null==t||null==e)throw"assetsFile and assetID can not be null!";if(this._anchorBindings=[],this._animSequence=[],this._fpsForAnims={},this._destroyed=!1,this.assetsFile!=t||this.assetID!=e&&this._baseAssetID!=e){this.assetsFile=t,this.currentAnim=null,this.assetID=this._handleSumAnims(e),this.define=this.getDefine();var i=this.define.anchorX,n=this.define.anchorY;isNaN(i)||isNaN(n)||this.setAnchorPoint(i,n),0==this.fps&&(this.fps=this.define.fps),this.onNewSource(),this.currentFrame=0,this._initFrameLabels(),this.renderFrame(this.currentFrame,!0),this._initColliders(),this.parent,null==this.__pool__id__&&(this.__pool__id__=this.assetID),this.currentAnim}},e.prototype.setAnchorPoint=function(t,e){},Object.defineProperty(e.prototype,"fps",{get:function(){return this._fps},set:function(t){this._fps=t},enumerable:!0,configurable:!0}),e.prototype._handleSumAnims=function(t){var e=t.split("$");this._baseAssetID=e[0],this._subAnims=XFlash.assetsManager.getSubAnims(this.assetsFile,this._baseAssetID);var i=e[1];return null==i&&this._subAnims&&(i=this._subAnims[0]),t=this._baseAssetID,i&&(t=this._baseAssetID+"$"+i,this.currentAnim=i),t},e.prototype._initFrameLabels=function(){this._labelFrames=[],this._frameSounds={};var t=this.define.labels;if(t)for(var e in t){var i=t[e];e.indexOf("@")>-1||this._labelFrames.push(i.start)}},e.prototype.setFpsForAnim=function(t,e){this._fpsForAnims[t]=e},e.prototype.addFrameSound=function(t,e){this._frameSounds[""+t]=e},e.prototype.removeFrameSound=function(t){delete this._frameSounds[""+t]},e.prototype.getLabels=function(t){return this.define.labels?this.define.labels[t]:null},e.prototype.hasLabel=function(t){return null!=this.getLabels(t)},e.prototype.getMainCollider=function(){return this.getCollider("main")||this._mainCollider},e.prototype.getCollider=function(t){var e=null;if(this._colliders){var i=this._colliders[t];null!=i&&(e=i[this.currentFrame])}return e},e.prototype._initColliders=function(){},e.prototype.getRect=function(t){return this.getMainCollider().getRect(t)},e.prototype.debugDraw=function(){this.getMainCollider().debugDraw()},e.prototype.getCenter=function(t){return this.getMainCollider().getCenter(t)},e.prototype.getAnchor=function(t){return null},e.prototype.bindAnchor=function(t,e,i){return!1},e.prototype.unbindAnchor=function(t,e){},e.prototype.getCurrentLabel=function(){var t=this.define.labels;if(!t)return null;for(var e in t){var i=t[e];if(this.currentFrame>=i.start&&this.currentFrame<=i.end)return e}return null},e.prototype.nextFrame=function(){this.gotoAndStop(Math.min(++this.currentFrame,this.totalFrames-1))},e.prototype.prevFrame=function(){this.gotoAndStop(Math.max(--this.currentFrame,0))},e.prototype.play=function(t){void 0===t&&(t=!1),t!==!0?(this._loopStart=0,this._loopEnd=this.totalFrames-1):(this._animReversed=!0,this._loopStart=this.totalFrames-1,this.currentFrame=this._loopStart,this._loopEnd=0),this.updatePlaying(!0),this.currentAnim=null},e.prototype.playSequence=function(t){if(null==t)return!1;if(t instanceof Array||(t=Array.prototype.slice.call(arguments)),0==t.length)return!1;this._loopSequence=!1,this._sequenceIndex=0;var e=this.gotoAndPlay(t[0]);return this._animSequence=t,e},e.prototype.playSequenceLoop=function(t){t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.playSequence(t),this._loopSequence=!0},e.prototype.stopSequence=function(){this._loopSequence=!1,this._animSequence.length=0},e.prototype._setSubAnim=function(t,e){return t&&0!=t.length?null==this._subAnims||-1==this._subAnims.indexOf(t)?(this.__isButton||console.log("There is no animation named: "+t),!1):(this.setSource(this.assetsFile,this._baseAssetID+"$"+t),e===!1?this.gotoAndStop(0):(this._fpsForAnims[t]&&this.setFPS(this._fpsForAnims[t]),this.gotoAndPlay(0)),this.currentAnim=t,this._animTime=0,!0):!1},e.prototype.gotoAndPlay=function(t,e){if(void 0===e&&(e=!1),this._animReversed=!1,this._isLanguageElement||this.__isButton)return!1;if("string"==typeof t){if(this.playing&&this.currentAnim==t&&e!==!0)return!0;var i=this.getLabels(t);if(null==i){var n=this._setSubAnim(t,!0);return n||this.play(),n}this._loopStart=i.start,this._loopEnd=i.end,this.currentFrame=this._loopStart,this.currentAnim=t,this._fpsForAnims[t]&&this.setFPS(this._fpsForAnims[t])}else{if(!this.isValideFrame(t))return console.log("The frame: "+t+" is out of range!"),!1;this._loopStart=0,this._loopEnd=this.totalFrames-1,this.currentFrame=t,this.currentAnim=null}return this.renderFrame(this.currentFrame),this.updatePlaying(!0),this._animTime=0,!0},e.prototype.stop=function(){this._animReversed=!1,this.updatePlaying(!1),this.currentAnim=null},e.prototype.gotoAndStop=function(t){if(this._animReversed=!1,isNaN(t)){var e=this.getLabels(t);if(null==e){var i=this._setSubAnim(t,!1);return i||this.__isButton||console.log("There is no animation named: "+t),i}t=e.start}return this.currentAnim=null,this.isValideFrame(t)?(this.updatePlaying(!1),this.currentFrame=t,this.renderFrame(t),!0):(console.log("The frame: "+t+" is out of range!"),!1)},e.prototype.setFPS=function(t){this._fps!=t&&(this._fps=t,this.updateSchedule())},e.prototype.getFPS=function(){return this._fps},e.prototype.updatePlaying=function(t){this.playing!=t&&(this.playing=t,this.updateSchedule())},e.prototype.updateSchedule=function(){this.playing?this.totalFrames>1&&this.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this):this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},e.prototype.onFrame=function(t){if(this.visible){var e=1,i=this._animReversed,n=i?-1:1;this.currentFrame+=n,this._animTime+=e;var s=i?this.currentFrame<this._loopEnd:this.currentFrame>this._loopEnd;s&&(this.currentFrame=this._loopEnd,(this.autoDestroyWhenOver||this.autoStopWhenOver||this.autoHideWhenOver)&&this.updatePlaying(!1),this.dispatchEventWith(FlashEvent.ANIMATION_COMPLETE),this.autoDestroyWhenOver?this.destroy():this.autoHideWhenOver?this.visible=!1:this._animSequence.length?this._playNext():this.autoStopWhenOver||(this.currentFrame=this._loopStart),this._animTime=0),s=i?this.currentFrame<this._loopEnd:this.currentFrame>this._loopEnd;var r=i?this.currentFrame<0:this.currentFrame>this.totalFrames-1;(s||r)&&(this.currentFrame=this._loopStart),this.renderFrame(this.currentFrame)}},e.prototype._playNext=function(){},e.prototype.isValideFrame=function(t){return t>=0&&t<this.totalFrames},e.prototype.renderFrame=function(t,e){void 0===e&&(e=!1),(this._prevFrame!=t||1==e)&&(this._prevFrame!=t&&(this._prevFrame=t),this._handleAnchorBindings(),this._updateCollider(),this.doRenderFrame(t),this.dispatchEventWith(FlashEvent.ANIMATION_UPDATE,!1,t))},e.prototype._handleAnchorBindings=function(){},e.prototype._updateAnchorNode=function(t,e){null!=e&&(t.x=e.x,t.y=e.y,t.zIndex=e.zIndex,t.rotation=e.rotation,t.setScaleX(e.scaleX),t.setScaleY(e.scaleY))},e.prototype.onEnter=function(){},e.prototype.onExit=function(){this._destroyed=!0},e.prototype._updateLaguage=function(){},e.prototype._updateCollider=function(){},e.prototype.setPosition=function(t,e){this.x=t,this.y=e},e.prototype.setPositionX=function(t){this.setPosition(t,this.getPositionY())},e.prototype.setPositionY=function(t){this.setPosition(this.getPositionX(),t)},e.prototype.getPositionY=function(){return this.y},e.prototype.getPositionX=function(){return this.x},e.prototype.destroy=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),this.autoRecycle,this.parent&&this.parent.removeChild(this)},e.prototype.setScale=function(t){this.scaleX=t,this.scaleY=t},Object.defineProperty(e.prototype,"opacity",{get:function(){return this.alpha},set:function(t){this.alpha=t},enumerable:!0,configurable:!0}),e.prototype.onRecycle=function(){this.autoRecycle=!1,this.setScale(1),this.opacity=1,this.rotation=0,this.autoDestroyWhenOver=!1,this.autoStopWhenOver=!1,this.autoHideWhenOver=!1,this.ignoreBodyRotation=!1,this.gotoAndStop(0),this.setPosition(0,0),this._animSequence.length=0,this._loopSequence=!1,this._sequenceIndex=0,this._animReversed=!1,this.currentAnim=null,this.__isInputMask=!1},e.prototype.isMouseEnabled=function(){return this._mouseEnabled},e.prototype.setMouseEnabled=function(t){this._mouseEnabled=t},e.prototype.getDefine=function(){var t=XFlash.assetsManager.getDisplayDefine(this.assetsFile,this.assetID);if(null==t)throw"There is no Animator named: "+this.assetID+" in assets: "+this.assetsFile+", or make sure this class extends from the proper class!";return t},e.prototype.onNewSource=function(){var t=this.define.start,e=this.define.end;this.frameNames=XFlash.assetsManager.getFrameNames(this.assetsFile,t,e),this.totalFrames=this.frameNames.length,this.totalFrames>1?this.__isMovieClip=!0:this.__isMovieClip=!1,0==this.totalFrames},e.prototype.doRenderFrame=function(t){var e,i,n,s=this.define.type;if(i=XFlash.swfUrl+this.define.url,"jpg"==s||"png"==s){if(n=XFlash.getNameByURL(i),!n)throw"This file not exist!"+n;e=RES.getRes(n)}else{var r=XFlash.assetsManager.sheetstMap[this.assetsFile];e=r.getTexture(this.frameNames[t])}if(e){this.bitmap.texture=e;var o=this.define.anchorX,a=1-this.define.anchorY;this.anchorOffsetX=this.bitmap.measuredWidth*o,this.anchorOffsetY=this.bitmap.measuredHeight*a}},e.prototype.doRenderImage=function(t){RES.getResByUrl(t,function(t){this.bitmap.texture=t;var e=this.define.anchorX,i=1-this.define.anchorY;this.anchorOffsetX=this.bitmap.measuredWidth*e,this.anchorOffsetY=this.bitmap.measuredHeight*i},this,RES.ResourceItem.TYPE_IMAGE)},Object.defineProperty(e.prototype,"autoPlayChildren",{get:function(){return this._autoPlayChildren},set:function(t){this._autoPlayChildren=t},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer),XMovieClip=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.clsName="XMovieClip",n.touchChildren=!0,n.bitmap&&(n.removeChild(n.bitmap),n.bitmap=null),n}return __extends(e,t),e.prototype.getDefine=function(){var t=XFlash.assetsManager.getMc(this.assetsFile,this.assetID);if(null==t)throw"There is no MovieClip named: "+this.assetID+" in assets: "+this.assetsFile+", or make sure this class extends from the proper class!";return t},e.prototype.destroy=function(){this.stop(),this.removeAllDefineChildren(),t.prototype.destroy.call(this)},e.prototype.removeAllDefineChildren=function(){if(this.define){var t;for(var e in this.define.children)t=this.namedChildren[e],t&&(t.destroy?t.destroy():this.removeChild(t)),delete this.namedChildren[e],delete this[e]}},e.prototype.getSortDefine=function(){var t,e=[];for(var i in this.define.children)t=this.define.children[i],t.childName=i,e.push(t);return e.sort(function(t,e){return t.zIndex-e.zIndex}),e},e.prototype.doRenderFrame=function(t){for(var i,n,s,r=null,o=this.define.anchorX,a=1-this.define.anchorY,h=-this._theRect.width*o,l=-this._theRect.height*a,u=this.getSortDefine(),p=0;p<u.length;p++)if(i=u[p],s=i.childName,n=this._frameDatas[s][t],r=this.namedChildren[s],n){null==r&&(r=null!=i.text?new XLabel(this.assetsFile,n,i):XFlash.assetsManager.createDisplay(i.assetsFile||this.assetsFile,i["class"],null,!1),this.namedChildren[s]=r,this[s]=r),r.name=s,n.setForChild(r,h,l);var c=-1==n.zIndex?i.zIndex:n.zIndex;r instanceof e&&(r.autoPlayChildren=this._autoPlayChildren),r.parent!=this?this.addChildAt(r,c):this.getChildIndex(r)!=c&&this.setChildIndex(r,c)}else r&&(r.destroy&&r.destroy(),delete this.namedChildren[s],delete this[s])},e.prototype.onNewSource=function(){this.namedChildren={},this.totalFrames=this.define.totalFrames,this._theRect=XFlash._strToRect(this.define.rect),this.$setWidth(this._theRect.width),this.$setHeight(this._theRect.height),this.totalFrames>1?this.__isMovieClip=!0:this.__isMovieClip=!1,this._initFrameDatas()},e.prototype._initFrameDatas=function(){this._frameDatas={};for(var t in this.define.children){for(var e=[],i=this.define.children[t].frames,n=-1;++n<i.length;){var s=i[n];s&&(s=s.split(","),e[n]=new FrameData(s,this._theRect))}this._frameDatas[t]=e}},Object.defineProperty(e.prototype,"autoPlayChildren",{get:function(){return this._autoPlayChildren},set:function(t){if(this._autoPlayChildren!=t){this._autoPlayChildren=t;for(var e in this.namedChildren){var i=this.namedChildren[e];i.autoPlayChildren=t}t?this.play():this.stop()}},enumerable:!0,configurable:!0}),e}(XSprite),FlashEvent=function(){function t(){}return t}();FlashEvent.ANIMATION_COMPLETE="ANIMATION_COMPLETE",FlashEvent.ANIMATION_UPDATE="ANIMATION_UPDATE";var FrameData=function(){function t(t,e){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.opacity=0,this.zIndex=0,this.skewX=0,this.skewY=0,this.font=null,this.fontSize=12,this.fontColor=0,this.textAlign=null,this.textWidth=0,this.textHeight=0,this._isText=!1,this._data=null,this._hasSkew=!1,this.rect=null,this._data=t,this.rect=e,this.x=parseFloat(t[0]),this.y=this.rect.height-parseFloat(t[1]),this.rotation=parseFloat(t[2]),this.scaleX=parseFloat(t[3]),this.scaleY=parseFloat(t[4]),this.opacity=parseFloat(t[5]),t.length>6&&(this.zIndex=parseInt(t[6])),t.length>7&&(this.skewX=parseFloat(t[7])),t.length>8&&(this.skewY=parseFloat(t[8])),this._hasSkew=t.length>7,t.length>9){this._isText=!0,this.font=t[9],this.fontSize=parseInt(t[10]);var i=t[11];i=i.replace("#","0x"),this.fontColor=i,this.textAlign=t[12],this.textWidth=parseFloat(t[13]),this.textHeight=parseFloat(t[14])}}return t.prototype.setForChild=function(t,e,i){this._hasSkew||(t.rotation=this.rotation),t.alpha=this.opacity,t.scaleX=this.scaleX,t.scaleY=this.scaleY,this._hasSkew&&(t.skewX=this.skewX,t.skewY=this.skewY);var n=this.x,s=this.y;this.font&&t instanceof XLabel&&(t.fontFamily=this.font,t.textAlign=this.textAlign,t.textColor=this.fontColor,t.size=this.fontSize,t.width=this.textWidth,t.height=this.textHeight,s+=3),t.x=n+e,t.y=s+i},t.prototype.clone=function(){return new t(this._data,this.rect)},t}(),ObjectPool=function(){function t(){this._objs=new Array}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.popByClassName=function(e,i,n){void 0===n&&(n=null);var s=e+"_"+i;s=n?e&&i?n+"_"+e+"_"+i:n:e+"_"+i,t._content[s]||(t._content[s]=[]);var r,o=t._content[s];if(o.length)r=o.pop();else{if(n){var a=egret.getDefinitionByName(n);r=new a(e,i)}else r=XFlash.assetsManager.createDisplay(e,i);r.ObjectPoolKey=s}return r},t.pushMC=function(e){if(e){var i;i=e.ObjectPoolKey?e.ObjectPoolKey:egret.getQualifiedClassName(e),t._content[i]||(t._content[i]=[]);var n=t._content[i];n.push(e)}},t.pop=function(e){for(var i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];t._content[e]||(t._content[e]=[]);var s=t._content[e];if(s.length)return s.pop();var r,o=egret.getDefinitionByName(e),a=i.length;return 0==a?r=new o:1==a?r=new o(i[0]):2==a?r=new o(i[0],i[1]):3==a?r=new o(i[0],i[1],i[2]):4==a?r=new o(i[0],i[1],i[2],i[3]):5==a&&(r=new o(i[0],i[1],i[2],i[3],i[4])),r.ObjectPoolKey=e,r},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var n,s=t._content[e];if(s.length)for(var r=0;r<s.length;r++)if(s[r].extraKey==i){n=s[r],s.splice(r,1);break}if(!n){var o=egret.getDefinitionByName(e);n=new o(i),n.extraKey=i,n.ObjectPoolKey=e}return n},t.push=function(e){if(null==e)return!1;var i=e.ObjectPoolKey;return t._content[i]?(t._content[i].push(e),!0):!1},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var n=t._content[e];n&&n.length;){var s=n.pop();i&&s[i](),s=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var n=t._content[e];if(null!=n){var s=0,r=n.length;for(s;r>s;s++)n[s][i]()}},t.recoverPool=function(e){for(var i=0;i<e.length;i++)t.push(e[i])},t}();ObjectPool._content={};var SoundManager=function(){function t(){}return t}(),XFlash=function(){function t(){}return t.init=function(t,e,i){void 0===e&&(e="resource/swfs/"),this.preLoadGroup=i,this.stage=t,this.swfUrl=e,this.assetsManager=new AssetsManager},t.getNameByURL=function(t){var e;for(var i in this.preLoadGroup)if(e=this.preLoadGroup[i],e.url==t)return e.name;return null},t._strToRect=function(t){var e=t.split(",");return new egret.Rectangle(parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]))},t.replaceScene=function(e,i){void 0===i&&(i=-1),t.currentScene&&t.currentScene.parent&&(t.currentScene.touchChildren=!1,t.currentScene.touchEnabled=!1,t.currentScene.parent.removeChild(t.currentScene),t.currentScene=null);var n=new e;i>0&&(n.touchChildren=!1,n.touchEnabled=!1,n.alpha=0,egret.Tween.get(n,null,null,!0).to({alpha:1},i).call(function(){this.touchChildren=!0,this.touchEnabled=!0,this.onFadeInComplete&&this.onFadeInComplete()},n)),t.stage.addChild(n)},t.getSoundEnabled=function(){return t.soundEnabled},t.setSoundEnabled=function(e){t.soundEnabled=e,e?this.resumeAllSound():this.stopAllSound()},t.resumeAllSound=function(){this.bgSound&&(this.bgSoundChannel=this.bgSound.play(0,0))},t.stopAllSound=function(){this.bgSoundChannel&&(this.bgSoundPosition=this.bgSoundChannel.position,this.bgSoundChannel.stop(),this.bgSoundChannel=null);for(var t;this.soundPlayArr.length>0;)t=this.soundPlayArr.pop(),t.channel&&t.channel.stop(),t.channel=null,t=null},t.stopSound=function(e){var i=t.soundPlayArr.indexOf(e);i>-1&&t.soundPlayArr.splice(i,1),e.channel.stop(),e.channel=null,e=null},t.stopBgSound=function(){this.bgSoundChannel&&this.bgSoundChannel.stop(),this.bgSoundChannel=null,this.bgSound=null},t.playSound=function(e){t.soundEnabled&&(this.bgSoundChannel&&this.bgSoundChannel.stop(),this.bgSoundChannel=null,this.bgSound=null,this.bgSound=RES.getRes(e),this.bgSoundPosition=0,this.bgSoundChannel=this.bgSound.play(this.bgSoundPosition))},t.playEffect=function(e,i){if(void 0===i&&(i=1),t.soundEnabled){var n=RES.getRes(e);return this.soundPlayArr.push(n),n.channel=n.play(0,i),1==i&&n.channel.addEventListener(egret.Event.SOUND_COMPLETE,function(){this.channel=null,t.soundPlayArr.splice(t.soundPlayArr.indexOf(this),1)},n),n}},t.ifInRect=function(t,e,i){return e>=t.x&&e<=t.x+t.width&&i>=t.y&&i<=t.y+t.height?!0:!1},t.ifTouched=function(e,i,n){var s=e.getTransformedBounds(t.stage);return t.ifInRect(s,i,n)},t.ifCollision=function(e,i){var n=e.getTransformedBounds(t.stage),s=i.getTransformedBounds(t.stage);return t.ifInRect(s,n.x,n.y)||t.ifInRect(s,n.x+n.width,n.y)||t.ifInRect(s,n.x,n.y+n.height)||t.ifInRect(s,n.x+n.width,n.y+n.height)?!0:!1},t.randInt=function(t,e){return t+Math.floor(Math.random()*(e-t+1))},t.nameToObject=function(t,e){return void 0===e&&(e=null),egret.getDefinitionByName(t)},t.timeFormat=function(t){var e=function(t){return 10>t?"0"+t:t},i=t/1e3,n=Math.floor(i/3600),s=Math.floor((i-3600*n)/60),r=i-3600*n-60*s;return e(s)+":"+e(r)},t}();XFlash.assetsManager=null,XFlash.stage=null,XFlash.miniLogoUrl="resource/img/minilogo.png",XFlash.bgUrl="resource/img/mlbg.png",XFlash.logoUrl="resource/img/mllogo.png",XFlash.playUrl="resource/img/mlplay.png",XFlash.currentScene=null,XFlash.soundEnabled=!0,XFlash.swfUrl="resource/swfs/",XFlash.soundPlayArr=[],XFlash.soundPool={},XFlash.bgSoundPosition=0,XFlash.preLoadGroup=null;var XLabel=function(t){function e(e,i,n){var s=t.call(this)||this;return s._destroyed=!1,s.text=n.text,s.multiline=!0,1==n.input&&(s.type=egret.TextFieldType.INPUT),s._destroyed=!1,s}return __extends(e,t),e.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.parent&&this.parent.removeChild(this))},e}(egret.TextField),AssetsManager=function(){function t(){this.ASSET_NONE=0,this.ASSET_ANIMATOR=1,this.ASSET_MOVIE_CLIP=2,this.ASSET_IMAGE=3,this.framesCache={},this.displaysCache={},this.displayDefineCache={},this.mcsCache={},this.subAnimsCache={},this.sheetstMap={},this.init()}return t.prototype.init=function(){this.framesCache={},this.displaysCache={},this.displayDefineCache={},this.mcsCache={},this.subAnimsCache={},this.sheetstMap={}},t.prototype.createDisplay=function(t,e,i,n,s){if(void 0===i&&(i=null),void 0===n&&(n=!1),void 0===s&&(s=null),null==t||null==e)throw"Please give me assetsFile and assetID!";if(null==s&&i&&(s=i["class"]),i&&"string"==typeof i||s&&"string"!=typeof s)throw"Params error: maybe you are using the old api, please use the latest!";this.addAssets(t);var r=this.getSubAnims(t,e);r.length&&(e=e+"$"+r[0]);var o=this.getDisplayDefine(t,e);if(o&&"share"==o.type)return this.createDisplay(this._getSharedPlist(t,o),e,i,n,s);var a=null;if(null==a){var h=!1;if(null==o&&(o=this.getMc(t,e),h=!0),!o)throw"There is no display with assetID: "+e+" in assets file: "+t+", or make sure the display is not a BLANK symbol!";if(s=o.type,"null"!=s&&"jpg"!=s&&"png"!=s){if("progress"==s&&(s="xxhd.ProgressBar"),a=egret.getDefinitionByName(s))return new a(t,e);throw"this is class not exist"+s}}s=h?"XMovieClip":"XSprite";var a=egret.getDefinitionByName(s);return new a(t,e)},t.prototype.parserFrames=function(t,e){var i,n,s,r=/\{|\}/g;for(var o in e)i=e[o],n=i.frame,n=n.replace(r,""),s=n.split(","),i.x=s[0],i.y=s[1],i.w=s[2],i.h=s[3],t.createTexture(o,s[0],s[1],s[2],s[3])},t.prototype.addAssets=function(t){if("undefined"!=typeof this.framesCache[t])return!1;var e=t,i=RES.getRes(e);if(null==i)throw"Make sure you have pre-loaded the resource: "+t;var n=i.metadata.fps,s=[],r=i.frames,o=i.metadata.image;o=o.replace(".","_");var a=new egret.SpriteSheet(RES.getRes(o));this.sheetstMap[e]=a,this.parserFrames(a,r);for(var h in r)s.push(h);return s.sort(),this.framesCache[t]=s,i.displays&&this._parseDisplays(t,i.displays,n),i.mcs&&this._parseMovieClips(t,i.mcs,n),i.fonts,!0},t.prototype._parseDisplays=function(t,e,i){var n=[],s=null;for(var r in e)n.push(r),s=e[r],this.displayDefineCache[t+r]=s,this._parseSubAnims(t,r);this.displaysCache[t]=n},t.prototype._parseMovieClips=function(t,e,i){for(var n in e){var s,r=e[n],o=r.children;for(var a in o)s=o[a],s.frames=this._strToArray(s.frames);this.mcsCache[t+n]=r,this._parseSubAnims(t,n)}},t.prototype._parseSubAnims=function(t,e){var i=e.split("$"),n=i[0],s=i[1];if(n&&s&&""!=n&&""!=s){var r=t+n,o=this.subAnimsCache[r];null==o&&(o=[],this.subAnimsCache[r]=o),o.push(s)}},t.prototype._parseFrames=function(t){var e={};for(var i in t)e[i]=this._strToArray(t[i]);return e},t.prototype._strToArray=function(t){for(var e=t.split("|"),i=-1,n=[];++i<e.length;){var s=e[i];"null"===s?n.push(null):""===s?n.push(n[i-1]):n.push(s)}return n},t.prototype.getAssetType=function(t,e){if(this.getMc(t,e))return this.ASSET_MOVIE_CLIP;var i=this.getDisplayDefine(t,e);return i?"jpg"==i.type||"png"==i.type?this.ASSET_IMAGE:"share"==i.type?this.getAssetType(this._getSharedPlist(t,i),e):this.ASSET_ANIMATOR:this.ASSET_NONE},t.prototype.getSubAnims=function(t,e){this.addAssets(t);var i=t+e;return this.subAnimsCache[i]||[]},t.prototype.getMc=function(t,e){this.addAssets(t);var i=t+e;return this.mcsCache[i]},t.prototype.getDisplayDefine=function(t,e){this.addAssets(t);var i=t+e;return this.displayDefineCache[i]},t.prototype.getFrameNames=function(t,e,i){this.addAssets(t);var n=this.framesCache[t];return null==n?[]:(-1==e&&(e=0),-1==i&&(i=n.length-1),n.slice(parseInt(e),parseInt(i)+1))},t.prototype._getSharedPlist=function(t,e){var i=t.substring(t.indexOf("_")),n=e.url+i;return n},t.prototype.removeAssets=function(t){delete this.framesCache[t],delete this.displaysCache[t],delete this.displayDefineCache[t],delete this.mcsCache[t],delete this.subAnimsCache[t]},t.prototype.removeAllAssets=function(){for(var t in this.framesCache)this.removeAssets(t)},t}(),BaseScene=function(t){function e(){var e=t.call(this)||this;return e._miniLogoBmp=null,XFlash.currentScene=e,e}return __extends(e,t),e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),this.onResizeHandler(null)},e.prototype.onResizeHandler=function(t){},e.prototype.addChild=function(e){return t.prototype.addChild.call(this,e),this._miniLogoBmp&&this.setChildIndex(this._miniLogoBmp,this.numChildren-1),e},e.prototype.destroy=function(){for(;this.numChildren>0;)this.removeChildAt(0)},e.prototype.onFadeInComplete=function(){},e.prototype.bindFullScreenButton=function(t){console.assert(t,"can not found fullScreenButton"),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){App.ClickFullscreen()},this),t.visible=App.FullscreenEnabled},e.prototype.bindCreditsButton=function(t){console.assert(t,"can not found creditsButton"),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){App.ClickCredits()},this),t.visible=App.CreditsEnabled},e.prototype.bindMoreButton=function(t){console.assert(t,"can not found moreButton"),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){App.ClickMore()},this),t.visible=App.MoreGamesButtonEnabled},e.prototype.bindSoundButton=function(t){console.assert(t,"can not found soundButton"),XFlash.getSoundEnabled()&&t.gotoAndStop(0),XFlash.getSoundEnabled()||t.gotoAndStop(1),t.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var e=XFlash.getSoundEnabled();t.gotoAndStop(e?1:0),XFlash.setSoundEnabled(!e)},this)},e.prototype.onMiniLogo=function(t){App.ClickLogo()},e.prototype._createMiniLogo=function(){if(!this._miniLogoBmp){var t=App.textures.miniLogoUrl,i=new egret.Bitmap;t?i.texture=t:i.texture=RES.getRes("minilogo_png"),i.touchEnabled=!0,this.addChild(i),this._miniLogoBmp=i,this.aliginLogo(e.miniLogoAlign),this._miniLogoBmp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onMiniLogo,this)}},e.prototype.aliginLogo=function(t){if("NONE"==t)return this._miniLogoBmp.visible=!1,void(e.miniLogoNone=!0);e.miniLogoNone=!1,this._miniLogoBmp.visible=!0;var i=0,n=0;switch(t){case"BL":i=0,n=XFlash.stage.stageHeight-this._miniLogoBmp.height;break;case"BM":i=(XFlash.stage.stageWidth-this._miniLogoBmp.width)/2,n=XFlash.stage.stageHeight-this._miniLogoBmp.height;break;case"BR":i=XFlash.stage.stageWidth-this._miniLogoBmp.width,n=XFlash.stage.stageHeight-this._miniLogoBmp.height;break;case"TL":i=0,n=0;break;case"TM":i=(XFlash.stage.stageWidth-this._miniLogoBmp.width)/2,n=0;break;case"TR":i=XFlash.stage.stageWidth-this._miniLogoBmp.width,n=0;break;case"MM":i=(XFlash.stage.stageWidth-this._miniLogoBmp.width)/2,n=(XFlash.stage.stageHeight-this._miniLogoBmp.height)/2;break;default:var s=t.split(",");i=parseFloat(s[0]),n=parseFloat(s[1])}this._miniLogoBmp.x=i,this._miniLogoBmp.y=n},e.prototype.setMiniLogo=function(t){t=t.toLocaleUpperCase(),e.miniLogoAlign=t,this._createMiniLogo(),this.aliginLogo(t)},e}(eui.Component);BaseScene.miniLogoNone=!1,BaseScene.miniLogoAlign="tl",BaseScene.VERSION="2.2.3";var xxhd;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._disp=null,e._msk=new egret.Shape,e.addChild(e._msk),e._drawMask(),e.visible=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype._drawMask=function(){this._msk.graphics.beginFill(0,.6),this._msk.graphics.drawRect(0,0,XFlash.stage.stageWidth,XFlash.stage.stageHeight),this._msk.graphics.endFill()},e.prototype.show=function(t,e,i,n){this._disp=t,this.addChild(t);var s=this;t.ok_btn&&t.ok_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e&&e.call(n),s.removeChild(t),s.visible=!1},n),t.no_btn&&t.no_btn.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){i&&i.call(n),s.removeChild(t),s.visible=!1},n),this.visible=!0},e}(egret.DisplayObjectContainer);t.AlertManager=e}(xxhd||(xxhd={}));var xxhd;!function(t){var e=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._percent=100,n._rect=null,n._rect=new egret.Rectangle(0,0,n.width,n.height),n}return __extends(e,t),Object.defineProperty(e.prototype,"percent",{get:function(){return this._percent},set:function(t){this._percent=t,this.scaleX=t},enumerable:!0,configurable:!0}),e}(XSprite);t.ProgressBar=e}(xxhd||(xxhd={}));var xxhd;!function(t){var e=function(t){function e(e,i,n,s){var r=t.call(this)||this;return r._tileWidth=0,r._tileHeight=0,r._mapWidth=0,r._mapHeight=0,r._rows=0,r._cols=0,r._objectsArr=null,r._tileWidth=e,r._tileHeight=i,r._rows=n,r._cols=s,r._mapWidth=e*n,r._mapHeight=i*s,r.initArray(n,s),r._tileContainer=new egret.DisplayObjectContainer,r.addChild(r._tileContainer),r._gridShape=new egret.Shape,r._gridShape.alpha=.4,r.addChildAt(r._gridShape,0),r}return __extends(e,t),e.prototype.removeAllTile=function(){for(var t,e=this._rows,i=this._cols,n=0;e>n;n++)for(var s=0;i>s;s++)0==n||1==n||0==s||1==s||n==e-1||n==e-2||s==i-1?this._objectsArr[n][s]=-1:(t=this._objectsArr[n][s],t&&t.parent&&t.destroy(),this._objectsArr[n][s]=null)},Object.defineProperty(e.prototype,"tileContainer",{get:function(){return this._tileContainer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"objectsArr",{get:function(){return this._objectsArr},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileWidth",{get:function(){return this._tileWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileHeight",{get:function(){return this._tileHeight},enumerable:!0,configurable:!0}),e.prototype.clearGrid=function(){this._gridShape.graphics.clear()},e.prototype.drawGrid=function(){this._gridShape.graphics.clear();for(var t,e,i=this._rows,n=this._cols,s=0;i>s;s++)for(var r=0;n>r;r++)t=s*this._tileWidth,e=r*this._tileHeight,null!=this._objectsArr[s][r]?(this._gridShape.graphics.beginFill(16711680,1),this._gridShape.graphics.lineStyle(1,16711935),this._gridShape.graphics.drawRect(t,e,this._tileWidth,this._tileHeight)):(0==s||1==s||0==r||1==r||s==i-1||s==i-2||r==n-1)&&(this._gridShape.graphics.lineStyle(1,16711935),this._gridShape.graphics.beginFill(16711680,1),this._gridShape.graphics.drawRect(t,e,this._tileWidth,this._tileHeight));this._gridShape.graphics.endFill()},Object.defineProperty(e.prototype,"mapWidth",{get:function(){return this._mapWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapHeight",{get:function(){return this._mapHeight
},enumerable:!0,configurable:!0}),e.prototype.initArray=function(t,e){this._objectsArr=[];for(var i=0;t>i;i++){this._objectsArr[i]=[];for(var n=0;e>n;n++)0==i||1==i||0==n||1==n||i==t-1||i==t-2||n==e-1?this._objectsArr[i][n]=-1:this._objectsArr[i][n]=null}},e.prototype.checkCollision=function(t,e){for(var i=null,n=0;n<this._rows;n++)for(var s=0;s<this._cols;s++)if(i=this._objectsArr[n][s],i instanceof egret.DisplayObject&&null!=i&&XFlash.ifTouched(i,t,e))return i;return null},e.prototype.update=function(){for(var t=null,e=0;e<this._rows;e++)for(var i=0;i<this._cols;i++)t=this._objectsArr[e][i],t instanceof egret.DisplayObject&&null!=t&&t.update&&t.update()},e.prototype.addTileByTileCoords=function(t,e,i){var n=this.tileToPixelCoords(e,i);t.x=n.x,t.y=n.y,t.setTile(this._objectsArr,e,i),this._tileContainer.addChild(t)},e.prototype.addTileByPixelCoords=function(t,e,i){var n=this.pixelToTileCoords(e,i);t.x=e,t.y=i,t.setTile(this._objectsArr,n.x,n.y),this._tileContainer.addChild(t)},e.prototype.tileBackPosition=function(t){t.goBack(this._objectsArr);var e=t.tilePos,i=this.tileToPixelCoords(e.x,e.y);t.x=i.x,t.y=i.y},e.prototype.checkExistTile=function(t,e,i,n){for(var s=null,r=t;t+i>r;r++)for(var o=e;e+n>o;o++)if(s=this._objectsArr[r][o])return s;return s},e.prototype.getEmptyTileCoords=function(){for(var t=0;t<this._rows;t++)for(var e=0;e<this._cols;e++)if(null==this._objectsArr[t][e])return new egret.Point(t,e);return null},e.prototype.addTile=function(t){this._tileContainer.addChild(t)},e.prototype.removeTile=function(t){this.clearTileCoords(t),t.destroy()},e.prototype.resortDepth=function(){for(var t,e=0,i=0;i<this._rows;i++){e=0;for(var n=0;n<this._cols;n++)t=this._objectsArr[i][n],t&&t instanceof egret.DisplayObject&&(this._tileContainer.setChildIndex(t,e),e++)}},e.prototype.getTileByPixcelCoords=function(t,e){var i=this.pixelToTileCoords(t,e),n=this._objectsArr[i.x][i.y];return n&&n instanceof egret.DisplayObject?n:null},e.prototype.getTileByTileCoords=function(t,e){var i=this._objectsArr[t][e];return i&&i instanceof egret.DisplayObject?i:null},e.prototype.topZorderTile=function(t){this._tileContainer.setChildIndex(t,this._tileContainer.numChildren-1)},e.prototype.clearTileCoords=function(t){t.clearTile(this._objectsArr)},e.prototype.pixelToTileX=function(t){return Math.floor(t/this._tileWidth)},e.prototype.pixelToTileY=function(t){return Math.floor(t/this._tileHeight)},e.prototype.tileToPixelCoords=function(t,e){return new egret.Point(t*this._tileWidth,e*this._tileHeight)},e.prototype.pixelToTileCoords=function(t,e){return new egret.Point(this.pixelToTileX(t),this.pixelToTileY(e))},e}(egret.DisplayObjectContainer);t.TileMap=e}(xxhd||(xxhd={}));var xxhd;!function(t){var e=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._tileX=-1,n._tileY=-1,n._tileOffX=1,n._tileOffY=1,n._preTileX=-1,n._preTileY=-1,n._data=null,n}return __extends(e,t),e.prototype._onRomoveFromStage=function(){t.prototype._onRomoveFromStage.call(this)},e.prototype.onTouchMe=function(){egret.Tween.get(this,null,null,!0).to({alpha:.6},100).to({alpha:1},100)},e.prototype.initTile=function(t,e,i){void 0===i&&(i=null),this._destroyed=!1,this._tileOffX=t,this._tileOffY=e,this._data=i},e.prototype.clearTile=function(t){if(-1!=this._tileX&&-1!=this._tileY){this._preTileX=this._tileX,this._preTileY=this._tileY;for(var e=this._tileX;e<this._tileX+this._tileOffX;e++)for(var i=this._tileY;i<this._tileY+this._tileOffY;i++)t[e][i]=null;this._tileX=-1,this._tileY=-1}},e.prototype.setTile=function(t,e,i){this._tileX=e,this._tileY=i;for(var n=this._tileX;n<this._tileX+this._tileOffX;n++)for(var s=this._tileY;s<this._tileY+this._tileOffY;s++)t[n][s]=this},e.prototype.goBack=function(t){this.setTile(t,this._preTileX,this._preTileY)},Object.defineProperty(e.prototype,"tilePos",{get:function(){return new egret.Point(this._tileX,this._tileY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileX",{get:function(){return this._tileX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileY",{get:function(){return this._tileY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileOffX",{get:function(){return this._tileOffX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileOffY",{get:function(){return this._tileOffY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._data=null,this._tileOffX=1,this._tileOffY=1,t.prototype.destroy.call(this)},e}(XMovieClip);t.XTileMovieClip=e}(xxhd||(xxhd={}));var xxhd;!function(t){var e=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._tileX=-1,n._tileY=-1,n._tileOffX=1,n._tileOffY=1,n._preTileX=-1,n._preTileY=-1,n._data=null,n}return __extends(e,t),e.prototype.onTouchMe=function(){egret.Tween.get(this,null,null,!0).to({alpha:.6},100).to({alpha:1},100)},e.prototype.getMapDataItem=function(){var t={nameid:this.data.nameid,tx:this.tileX,ty:this.tileY};return t},e.prototype.initTile=function(t,e,i){void 0===i&&(i=null),this._destroyed=!1,this._tileOffX=t,this._tileOffY=e,this._data=i},e.prototype.clearTile=function(t){if(-1!=this._tileX&&-1!=this._tileY){this._preTileX=this._tileX,this._preTileY=this._tileY;for(var e=this._tileX;e<this._tileX+this._tileOffX;e++)for(var i=this._tileY;i<this._tileY+this._tileOffY;i++)t[e][i]=null;this._tileX=-1,this._tileY=-1}},e.prototype.setTile=function(t,e,i){this._tileX=e,this._tileY=i;for(var n=this._tileX;n<this._tileX+this._tileOffX;n++)for(var s=this._tileY;s<this._tileY+this._tileOffY;s++)t[n][s]=this},e.prototype.goBack=function(t){this.setTile(t,this._preTileX,this._preTileY)},Object.defineProperty(e.prototype,"tilePos",{get:function(){return new egret.Point(this._tileX,this._tileY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileX",{get:function(){return this._tileX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileY",{get:function(){return this._tileY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileOffX",{get:function(){return this._tileOffX},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileOffY",{get:function(){return this._tileOffY},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._data=null,this._tileOffX=1,this._tileOffY=1},e}(XSprite);t.XTileSprite=e}(xxhd||(xxhd={}));